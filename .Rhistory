color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("GINI coefficient of inequality (residuals)", breaks = c(-.14, -.07, 0, .07, .14)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Economic Inequality vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.13, .13)) +
annotate("label", label = "United States (2006)", x = .038, y = .48, size = 3) +
annotate("segment", x=.035, y=.4, xend=0.028958659, yend=0.184436352, size=0.5, arrow=arrow(length=unit(.2, "cm")))
girafe(code = print(gini_plot), width_svg = 10)
girafe(code = print(imm_plot), width_svg = 10)
gini_plot <- ggplot(aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("GINI coefficient of inequality (residuals)", breaks = c(-.14, -.07, 0, .07, .14)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Economic Inequality vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.13, .13)) +
annotate("label", label = "United States (2006)", x = .04, y = .35, size = 2.8) +
annotate("segment", x=.035, y=.4, xend=0.028958659, yend=0.184436352, size=0.5, arrow=arrow(length=unit(.2, "cm")))
girafe(code = print(gini_plot), width_svg = 10)
gini_plot <- ggplot(aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("GINI coefficient of inequality (residuals)", breaks = c(-.14, -.07, 0, .07, .14)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Economic Inequality vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.13, .13)) +
annotate("label", label = "United States (2006)", x = .02, y = .42, size = 2.8) +
annotate("segment", x=.035, y=.4, xend=0.028958659, yend=0.184436352, size=0.5, arrow=arrow(length=unit(.2, "cm")))
girafe(code = print(gini_plot), width_svg = 10)
gini_plot <- ggplot(aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("GINI coefficient of inequality (residuals)", breaks = c(-.14, -.07, 0, .07, .14)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Economic Inequality vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.13, .13)) +
annotate("label", label = "United States (2006)", x = .02, y = .42, size = 2.8) +
annotate("segment", x=.03, y=.4, xend=0.028958659, yend=0.184436352, size=0.5, arrow=arrow(length=unit(.2, "cm")))
girafe(code = print(gini_plot), width_svg = 10)
gini_plot <- ggplot(aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("GINI coefficient of inequality (residuals)", breaks = c(-.14, -.07, 0, .07, .14)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Economic Inequality vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.13, .13)) +
annotate("label", label = "United States (2006)", x = .02, y = .42, size = 2.8) +
annotate("segment", x=.025, y=.4, xend=0.028958659, yend=0.184436352, size=0.5, arrow=arrow(length=unit(.2, "cm")))
girafe(code = print(gini_plot), width_svg = 10)
gini_plot <- ggplot(aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("GINI coefficient of inequality (residuals)", breaks = c(-.14, -.07, 0, .07, .14)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Economic Inequality vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.13, .13)) +
annotate("label", label = "United States (2006)", x = .015, y = .42, size = 2.8) +
annotate("segment", x=.025, y=.4, xend=0.028958659, yend=0.184436352, size=0.5, arrow=arrow(length=unit(.2, "cm")))
girafe(code = print(gini_plot), width_svg = 10)
gini_plot <- ggplot(aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("GINI coefficient of inequality (residuals)", breaks = c(-.14, -.07, 0, .07, .14)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Economic Inequality vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.13, .13)) +
annotate("label", label = "United States (2006)", x = .015, y = .42, size = 2.8) +
annotate("segment", x=.015, y=.42, xend=0.028958659, yend=0.184436352, size=0.5, arrow=arrow(length=unit(.2, "cm")))
girafe(code = print(gini_plot), width_svg = 10)
gini_plot <- ggplot(aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("GINI coefficient of inequality (residuals)", breaks = c(-.14, -.07, 0, .07, .14)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Economic Inequality vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.13, .13)) +
annotate("label", label = "United States (2006)", x = .015, y = .42, size = 2.8) +
annotate("segment", x=.015, y=.26, xend=0.028958659, yend=0.184436352, size=0.5, arrow=arrow(length=unit(.2, "cm")))
girafe(code = print(gini_plot), width_svg = 10)
gini_plot <- ggplot(aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("GINI coefficient of inequality (residuals)", breaks = c(-.14, -.07, 0, .07, .14)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Economic Inequality vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.13, .13)) +
annotate("label", label = "United States (2006)", x = .015, y = .42, size = 2.8) +
annotate("segment", x=.015, y=.28, xend=0.028958659, yend=0.184436352, size=0.5, arrow=arrow(length=unit(.2, "cm")))
girafe(code = print(gini_plot), width_svg = 10)
gini_plot <- ggplot(aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("GINI coefficient of inequality (residuals)", breaks = c(-.14, -.07, 0, .07, .14)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Economic Inequality vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.13, .13)) +
annotate("label", label = "United States (2006)", x = .015, y = .42, size = 2.8) +
annotate("segment", x=.015, y=.3, xend=0.028958659, yend=0.184436352, size=0.5, arrow=arrow(length=unit(.2, "cm")))
girafe(code = print(gini_plot), width_svg = 10)
gini_plot <- ggplot(aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("GINI coefficient of inequality (residuals)", breaks = c(-.14, -.07, 0, .07, .14)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Economic Inequality vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.13, .13)) +
annotate("label", label = "United States (2006)", x = .015, y = .42, size = 2.8) +
annotate("segment", x=.015, y=.295, xend=0.028958659, yend=0.184436352, size=0.5, arrow=arrow(length=unit(.2, "cm")))
girafe(code = print(gini_plot), width_svg = 10)
gini_plot <- ggplot(aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("GINI coefficient of inequality (residuals)", breaks = c(-.14, -.07, 0, .07, .14)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Economic Inequality vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.13, .13)) +
annotate("label", label = "United States (2006)", x = .015, y = .42, size = 2.8, color = "red") +
annotate("segment", x=.015, y=.295, xend=0.028958659, yend=0.184436352, size=0.5, arrow=arrow(length=unit(.2, "cm")))
girafe(code = print(gini_plot), width_svg = 10)
unique(gini_plot$data[[1]]["color"])
unique(gini_plot$data[[1]]["fill"])
gini_plot <- ggplot(aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("GINI coefficient of inequality (residuals)", breaks = c(-.14, -.07, 0, .07, .14)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Economic Inequality vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.13, .13)) +
annotate("label", label = "United States (2006)", x = .015, y = .42, size = 2.8, color = "United States 2011") +
annotate("segment", x=.015, y=.295, xend=0.028958659, yend=0.184436352, size=0.5, arrow=arrow(length=unit(.2, "cm")))
girafe(code = print(gini_plot), width_svg = 10)
gini_plot <- ggplot(aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("GINI coefficient of inequality (residuals)", breaks = c(-.14, -.07, 0, .07, .14)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Economic Inequality vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.13, .13)) +
annotate("label", label = "United States (2006)", x = .015, y = .42, size = 2.8, color = "red") +
annotate("segment", x = .015, y = .295, xend = 0.028958659, yend = 0.184436352, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))  +
annotate("label", label = "United States (2011)", x = .055, y = 1.05, size = 2.8, color = "red") +
annotate("segment", x = .015, y = .295, xend = 0.027958659, yend = 0.609561928, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))
girafe(code = print(gini_plot), width_svg = 10)
gini_plot <- ggplot(aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(GINI ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ `Ethnic Fractionalization Index` + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("GINI coefficient of inequality (residuals)", breaks = c(-.14, -.07, 0, .07, .14)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Economic Inequality vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.13, .13)) +
annotate("label", label = "United States (2006)", x = .015, y = .42, size = 2.8, color = "red") +
annotate("segment", x = .015, y = .295, xend = 0.028958659, yend = 0.184436352, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))  +
annotate("label", label = "United States (2011)", x = .048, y = 1.05, size = 2.8, color = "red") +
annotate("segment", x = .048, y = .925, xend = 0.027958659, yend = 0.609561928, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))
girafe(code = print(gini_plot), width_svg = 10)
resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist))
resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist, data = wvs_narm))
resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist, data = wvs_narm))
resid(glm(`Cultural Diversity Index` ~ GINI + `Ethnic Fractionalization Index` + ever_communist, data = wvs_narm))
resid(glm(Coefficients ~ GINI + `Ethnic Fractionalization Index` + ever_communist, data = wvs_narm))
eth_plot <- ggplot(aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("Ethnic fractionalization index (residuals)", breaks = c(-.25, -.2, -.15, -.1, -.05, 0, .05, .1, .15, .2, .25)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Ethnic Diversity vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.2325, .2325)) +
annotate("label", label = "United States (2006)", x = .015, y = .42, size = 2.8, color = "red") +
annotate("segment", x = .015, y = .295, xend = 0.116305718, yend = 0.76047741, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))  +
annotate("label", label = "United States (2011)", x = .048, y = 1.05, size = 2.8, color = "red") +
annotate("segment", x = .048, y = .925, xend = 0.116752803, yend = 1.18060926, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))
girafe(code = print(eth_plot), width_svg = 10)
eth_plot <- ggplot(aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("Ethnic fractionalization index (residuals)", breaks = c(-.25, -.2, -.15, -.1, -.05, 0, .05, .1, .15, .2, .25)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Ethnic Diversity vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.2325, .2325)) +
annotate("label", label = "United States (2006)", x = .015, y = .42, size = 2.8, color = "red") +
annotate("segment", x = .015, y = .295, xend = 0.116305718, yend = 0.76047741, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))  +
annotate("label", label = "United States (2011)", x = .048, y = 1.625, size = 2.8, color = "red") +
annotate("segment", x = .048, y = 1.5, xend = 0.116752803, yend = 1.18060926, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))
girafe(code = print(eth_plot), width_svg = 10)
eth_plot <- ggplot(aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("Ethnic fractionalization index (residuals)", breaks = c(-.25, -.2, -.15, -.1, -.05, 0, .05, .1, .15, .2, .25)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Ethnic Diversity vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.2325, .2325)) +
annotate("label", label = "United States (2006)", x = .015, y = .42, size = 2.8, color = "red") +
annotate("segment", x = .015, y = .295, xend = 0.116305718, yend = 0.76047741, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))  +
annotate("label", label = "United States (2011)", x = .054, y = 1.625, size = 2.8, color = "red") +
annotate("segment", x = .054, y = 1.5, xend = 0.116752803, yend = 1.18060926, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))
girafe(code = print(eth_plot), width_svg = 10)
eth_plot <- ggplot(aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("Ethnic fractionalization index (residuals)", breaks = c(-.25, -.2, -.15, -.1, -.05, 0, .05, .1, .15, .2, .25)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Ethnic Diversity vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.2325, .2325)) +
annotate("label", label = "United States (2006)", x = .015, y = .42, size = 2.8, color = "red") +
annotate("segment", x = .015, y = .295, xend = 0.116305718, yend = 0.76047741, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))  +
annotate("label", label = "United States (2011)", x = .054, y = 1.5, size = 2.8, color = "red") +
annotate("segment", x = .054, y = 1.375, xend = 0.116752803, yend = 1.18060926, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))
girafe(code = print(eth_plot), width_svg = 10)
eth_plot <- ggplot(aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("Ethnic fractionalization index (residuals)", breaks = c(-.25, -.2, -.15, -.1, -.05, 0, .05, .1, .15, .2, .25)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Ethnic Diversity vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.2325, .2325)) +
annotate("label", label = "United States (2006)", x = .015, y = .42, size = 2.8, color = "red") +
annotate("segment", x = .015, y = .295, xend = 0.116305718, yend = 0.76047741, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))  +
annotate("label", label = "United States (2011)", x = .07, y = 1.5, size = 2.8, color = "red") +
annotate("segment", x = .07, y = 1.375, xend = 0.116752803, yend = 1.18060926, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))
girafe(code = print(eth_plot), width_svg = 10)
eth_plot <- ggplot(aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("Ethnic fractionalization index (residuals)", breaks = c(-.25, -.2, -.15, -.1, -.05, 0, .05, .1, .15, .2, .25)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Ethnic Diversity vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.2325, .2325)) +
annotate("label", label = "United States (2006)", x = .07, y = .825, size = 2.8, color = "red") +
annotate("segment", x = .07, y = .6, xend = 0.116305718, yend = 0.76047741, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))  +
annotate("label", label = "United States (2011)", x = .07, y = 1.5, size = 2.8, color = "red") +
annotate("segment", x = .07, y = 1.375, xend = 0.116752803, yend = 1.18060926, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))
girafe(code = print(eth_plot), width_svg = 10)
eth_plot <- ggplot(aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("Ethnic fractionalization index (residuals)", breaks = c(-.25, -.2, -.15, -.1, -.05, 0, .05, .1, .15, .2, .25)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Ethnic Diversity vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.2325, .2325)) +
annotate("label", label = "United States (2006)", x = .07, y = .825, size = 2.8, color = "red") +
annotate("segment", x = .07, y = .6, xend = 0.116305718, yend = 0.76047741, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))  +
annotate("label", label = "United States (2011)", x = .07, y = 1.725, size = 2.8, color = "red") +
annotate("segment", x = .07, y = 1.6, xend = 0.116752803, yend = 1.18060926, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))
girafe(code = print(eth_plot), width_svg = 10)
eth_plot <- ggplot(aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("Ethnic fractionalization index (residuals)", breaks = c(-.25, -.2, -.15, -.1, -.05, 0, .05, .1, .15, .2, .25)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Ethnic Diversity vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.2325, .2325)) +
annotate("label", label = "United States (2006)", x = .07, y = 1.2, size = 2.8, color = "red") +
annotate("segment", x = .07, y = 1.075, xend = 0.116305718, yend = 0.76047741, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))  +
annotate("label", label = "United States (2011)", x = .07, y = 1.5, size = 2.8, color = "red") +
annotate("segment", x = .07, y = 1.375, xend = 0.116752803, yend = 1.18060926, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))
girafe(code = print(eth_plot), width_svg = 10)
eth_plot <- ggplot(aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_smooth(method = "glm",
aes(x = resid(glm(`Ethnic Fractionalization Index` ~ GINI + `Cultural Diversity Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Cultural Diversity Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("Ethnic fractionalization index (residuals)", breaks = c(-.25, -.2, -.15, -.1, -.05, 0, .05, .1, .15, .2, .25)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Ethnic Diversity vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.2325, .2325)) +
annotate("label", label = "United States (2006)", x = .07, y = 1.1, size = 2.8, color = "red") +
annotate("segment", x = .07, y = .975, xend = 0.116305718, yend = 0.76047741, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))  +
annotate("label", label = "United States (2011)", x = .07, y = 1.5, size = 2.8, color = "red") +
annotate("segment", x = .07, y = 1.375, xend = 0.116752803, yend = 1.18060926, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))
girafe(code = print(eth_plot), width_svg = 10)
girafe(code = print(eth_plot), width_svg = 10)
cult_plot <- ggplot(aes(x = resid(glm(`Cultural Diversity Index` ~ GINI + `Ethnic Fractionalization Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Ethnic Fractionalization Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_point_interactive(aes(tooltip = Country_survey_year)) +
geom_smooth(method = "glm",
aes(x = resid(glm(`Cultural Diversity Index` ~ GINI + `Ethnic Fractionalization Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Ethnic Fractionalization Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("Cultural diversity index (residuals)", breaks = c(-.18, -.12, -.06, 0, .06, .12, .18)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Cultural Diversity vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.168, .168)) + guides(color = F) +
annotate("label", label = "United States (2006)", x = .07, y = 1.1, size = 2.8, color = "red") +
annotate("segment", x = .07, y = .975, xend = -0.081163106, yend = 0.578838971, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))  +
annotate("label", label = "United States (2011)", x = .07, y = 1.5, size = 2.8, color = "red") +
annotate("segment", x = .07, y = 1.375, xend = -0.081252982, yend = 0.997707262, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))
girafe(code = print(cult_plot), width_svg = 10)
cult_plot <- ggplot(aes(x = resid(glm(`Cultural Diversity Index` ~ GINI + `Ethnic Fractionalization Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Ethnic Fractionalization Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_point_interactive(aes(tooltip = Country_survey_year)) +
geom_smooth(method = "glm",
aes(x = resid(glm(`Cultural Diversity Index` ~ GINI + `Ethnic Fractionalization Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Ethnic Fractionalization Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("Cultural diversity index (residuals)", breaks = c(-.18, -.12, -.06, 0, .06, .12, .18)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Cultural Diversity vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.168, .168)) + guides(color = F) +
annotate("label", label = "United States (2006)", x = -.03, y = 1.1, size = 2.8, color = "red") +
annotate("segment", x = -.03, y = .975, xend = -0.081163106, yend = 0.578838971, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))  +
annotate("label", label = "United States (2011)", x = -.03, y = 1.5, size = 2.8, color = "red") +
annotate("segment", x = -.03, y = 1.375, xend = -0.081252982, yend = 0.997707262, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))
girafe(code = print(cult_plot), width_svg = 10)
cult_plot <- ggplot(aes(x = resid(glm(`Cultural Diversity Index` ~ GINI + `Ethnic Fractionalization Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Ethnic Fractionalization Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_point_interactive(aes(tooltip = Country_survey_year)) +
geom_smooth(method = "glm",
aes(x = resid(glm(`Cultural Diversity Index` ~ GINI + `Ethnic Fractionalization Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Ethnic Fractionalization Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("Cultural diversity index (residuals)", breaks = c(-.18, -.12, -.06, 0, .06, .12, .18)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Cultural Diversity vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.168, .168)) + guides(color = F) +
annotate("label", label = "United States (2006)", x = -.04, y = .9, size = 2.8, color = "red") +
annotate("segment", x = -.04, y = .775, xend = -0.081163106, yend = 0.578838971, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))  +
annotate("label", label = "United States (2011)", x = -.03, y = 1.5, size = 2.8, color = "red") +
annotate("segment", x = -.03, y = 1.375, xend = -0.081252982, yend = 0.997707262, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))
girafe(code = print(cult_plot), width_svg = 10)
cult_plot <- ggplot(aes(x = resid(glm(`Cultural Diversity Index` ~ GINI + `Ethnic Fractionalization Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Ethnic Fractionalization Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_point_interactive(aes(tooltip = Country_survey_year)) +
geom_smooth(method = "glm",
aes(x = resid(glm(`Cultural Diversity Index` ~ GINI + `Ethnic Fractionalization Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Ethnic Fractionalization Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("Cultural diversity index (residuals)", breaks = c(-.18, -.12, -.06, 0, .06, .12, .18)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Cultural Diversity vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.168, .168)) + guides(color = F) +
annotate("label", label = "United States (2006)", x = -.04, y = .9, size = 2.8, color = "red") +
annotate("segment", x = -.04, y = .775, xend = -0.081163106, yend = 0.578838971, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))  +
annotate("label", label = "United States (2011)", x = -.04, y = 1.5, size = 2.8, color = "red") +
annotate("segment", x = -.04, y = 1.375, xend = -0.081252982, yend = 0.997707262, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))
girafe(code = print(cult_plot), width_svg = 10)
cult_plot <- ggplot(aes(x = resid(glm(`Cultural Diversity Index` ~ GINI + `Ethnic Fractionalization Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Ethnic Fractionalization Index` + ever_communist)),
color = Country), data = wvs_narm) +
geom_point_interactive(aes(tooltip = Country_survey_year)) +
geom_smooth(method = "glm",
aes(x = resid(glm(`Cultural Diversity Index` ~ GINI + `Ethnic Fractionalization Index` + ever_communist)),
y = resid(glm(Coefficients ~ GINI + `Ethnic Fractionalization Index` + ever_communist))),
inherit.aes = F) + geom_point_interactive(aes(tooltip = Country_survey_year), show.legend = F) +
scale_x_continuous("Cultural diversity index (residuals)", breaks = c(-.18, -.12, -.06, 0, .06, .12, .18)) +
scale_y_continuous("Economic-racial ideology association (residuals)", breaks = c(-2.5, -2, -1.5, -1, -.5, 0, .5, 1, 1.5, 2, 2.5)) +
labs(caption = "Partial multiple linear regression plot") +
ggtitle("Cultural Diversity vs. Economic Ideology-Racial Resentment Association") +
theme(title = element_text(size = 12)) + coord_cartesian(ylim = c(-2.5, 2.5), xlim = c(-.168, .168)) + guides(color = F) +
annotate("label", label = "United States (2006)", x = -.04, y = .9, size = 2.8, color = "red") +
annotate("segment", x = -.04, y = .775, xend = -0.081163106, yend = 0.578838971, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))  +
annotate("label", label = "United States (2011)", x = -.04, y = 1.4, size = 2.8, color = "red") +
annotate("segment", x = -.04, y = 1.275, xend = -0.081252982, yend = 0.997707262, size = 0.5,
arrow = arrow(length = unit(.2, "cm")))
girafe(code = print(cult_plot), width_svg = 10)
girafe(code = print(cult_plot), width_svg = 10)
